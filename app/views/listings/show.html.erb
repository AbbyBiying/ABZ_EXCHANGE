<% if @listing.exchange.present? %>
  <b>Exchange in process</b>
<% end %>

<% if (current_user == @listing.user && @listing.accepted?) %>
  <p> If you want to complete this exchange, hit the button</p>
  <%= button_to "exchange page", exchange_path(@listing.exchange), method: :get %>
<% end %>

<%= render @listing %>
<% unless (@listing.user != current_user || @listing.accepted?) %>
  <div class="button">
    <b><%= link_to "Edit this listing", edit_listing_path(@listing), method: :get %></b><br>

    <b><%= link_to "Delete this listing", listing_path(@listing),
         method: :delete, data: { confirm: 'Are you sure you want to delete this listing?' } %></b>
  </div>
<% end %>
<br>

<div>
  <% unless (@listing.user == current_user ||  @listing.accepted?) %>
    <h3>Make an offer</h3>
    <%= form_for [@listing, @offer] do |form| %>
      <div>
        <%= form.text_field :name, placeholder: "type name here"%>
      </div>

      <div>
        <%= form.text_area :description, placeholder: "type description here" %>
      </div>

      <div>
        <%= form.text_field :url, placeholder: "type image url here" %>
      </div>
      <%= form.submit %>
    <% end %>
  <% end %>
</div>

<%= render @listing.offers.by_most_recent %>
